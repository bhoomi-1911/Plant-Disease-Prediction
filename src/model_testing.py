# -*- coding: utf-8 -*-
"""model_testing

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/#fileId=https%3A//storage.googleapis.com/kaggle-colab-exported-notebooks/bhoomi1911/model-testing.302e8233-9f5c-4ac9-82fd-27937aba402e.ipynb%3FX-Goog-Algorithm%3DGOOG4-RSA-SHA256%26X-Goog-Credential%3Dgcp-kaggle-com%2540kaggle-161607.iam.gserviceaccount.com/20250831/auto/storage/goog4_request%26X-Goog-Date%3D20250831T073437Z%26X-Goog-Expires%3D259200%26X-Goog-SignedHeaders%3Dhost%26X-Goog-Signature%3D6f22d68b69d4a1c39558aeaf28b164cc49fe97673e3650cd7349a68b58e90fbec61a79291e5a4a5c5e21ba6de890575f7e5ed7182fbcccab2b4505c667ed9122375b9180f85bea742d9b1ea8357238711332338864fa25e6c1511f671fbedc6d98e790eb660a89d8f34a308185f6434ad5fe54f2104d58c3c07ddb48d3c52e02858a5690f147acd3f0bf807b5e8dc9714a70acb1359e5e400137ffdec40b41ec973b09387ce0c1bc32b4378adb14a2d6fae1e19e351b63231bb9478ed599a2cc0b7e4d7cbb07677c74d1efc66c6d24836ed8027bb59e4bdc1bbefa378030fe4f4afc8846a76d781385c34fe270f7c645f0e1a375b3d0eb43424290230899ba30
"""

# IMPORTANT: SOME KAGGLE DATA SOURCES ARE PRIVATE
# RUN THIS CELL IN ORDER TO IMPORT YOUR KAGGLE DATA SOURCES.
import kagglehub
kagglehub.login()

# IMPORTANT: RUN THIS CELL IN ORDER TO IMPORT YOUR KAGGLE DATA SOURCES,
# THEN FEEL FREE TO DELETE THIS CELL.
# NOTE: THIS NOTEBOOK ENVIRONMENT DIFFERS FROM KAGGLE'S PYTHON
# ENVIRONMENT SO THERE MAY BE MISSING LIBRARIES USED BY YOUR
# NOTEBOOK.

vipoooool_new_plant_diseases_dataset_path = kagglehub.dataset_download('vipoooool/new-plant-diseases-dataset')
bhoomi1911_my_model_tensorflow2_default_1_path = kagglehub.model_download('bhoomi1911/my_model/TensorFlow2/default/1')
bhoomi1911_plant_disease_detection_tensorflow2_default_1_path = kagglehub.model_download('bhoomi1911/plant_disease_detection/TensorFlow2/default/1')

print('Data source import complete.')

import numpy as np
import tensorflow as tf
from tensorflow.keras.preprocessing.image import ImageDataGenerator
import matplotlib.pyplot as plt

model = tf.keras.models.load_model(
    '/kaggle/input/my_model/tensorflow2/default/1/my_model.h5'
)

model.summary()

import cv2
image="/kaggle/input/new-plant-diseases-dataset/test/test/TomatoYellowCurlVirus1.JPG"

img=cv2.imread(image)
img=cv2.cvtColor(img,cv2.COLOR_BGR2RGB)

plt.imshow(img)
plt.title("Test image")
plt.xticks([])
plt.yticks([])
plt.show()

image=tf.keras.preprocessing.image.load_img(image,target_size=(128,128))
input_arr=tf.keras.preprocessing.image.img_to_array(image)
input_arr=np.array([input_arr])
print(input_arr.shape)

valid_set=tf.keras.utils.image_dataset_from_directory(
    directory="/kaggle/input/new-plant-diseases-dataset/New Plant Diseases Dataset(Augmented)/New Plant Diseases Dataset(Augmented)/valid",
    labels="inferred",
    label_mode="categorical",
    class_names=None,
    color_mode="rgb",
    batch_size=32,
    image_size=(128,128),
    shuffle=True,
    seed=None,
    validation_split=None,
    subset=None,
    interpolation="bilinear",
    follow_links=False,
    crop_to_aspect_ratio=False,
    pad_to_aspect_ratio=False,
    data_format=None,
    verbose=True,
)

class_name=valid_set.class_names

prediction=model.predict(input_arr)
result=np.argmax(prediction)
plt.imshow(img)
plt.title("Disease:"+class_name[result])
plt.xticks([])
plt.yticks([])
plt.show()